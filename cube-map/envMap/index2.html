<!DOCTYPE html>
<html>
  <head>
    <title>Hello, WebVR! - A-Frame</title>
    <meta name="description" content="Hello, WebVR! - A-Frame">
    <script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <a-cubemap id="sky">
          <img src="./back.jpg">
          <img src="./front.jpg">
          <img src="./bottom.jpg">
          <img src="./top.jpg">
          <img src="./left.jpg"> 
          <img src="./right.jpg">
        </a-cubemap>
      </a-assets>

      <!-- <a-box position="0 2 -3" rotation="0 45 0" color="#4CC3D9"></a-box> -->

      <a-entity position="1 2 -10" rotation="0 45 0" scale="1 1 1" color="#4CC3D9" geometry="primitive: box" material="envMap: #sky; roughness: 0; metalness: 0.5; opacity:0" opacity="0" visible="false"></a-entity>

      <!-- <a-entity position="-3 2 -10" rotation="0 45 0" scale="1 1 1" color="#4CC3D9" geometry="primitive: box" material="envMap: #sky;roughness: 0; metalness: 0.5; opacity:1"></a-entity> -->
            
      <a-entity id="cube1" position="0 0 0" color="#4CC3D9" geometry="primitive: box; height: 10; width: 10; depth: 10;" material=" roughness: 0.5; metalness: 0.5; opacity:1; side: back;"></a-entity>
      
      <a-sky color="red"></a-sky>
    </a-scene>
  </body>
  <script type="text/javascript">
    var scene = document.querySelector('a-scene');
    // var acubemap = document.querySelector('a-cubemap');
    var cube = document.querySelector('#cube1');
    // var assets = document.querySelector('a-assets');

    if (scene.hasLoaded) {
      run();
    } else {
      scene.addEventListener('loaded', run);
    }

    // if(acubemap.hasLoaded){
    //   console.log("acubemap loaded");
    // }else{
    //   acubemap.addEventListener('loaded', function(){
    //     console.log("acubemap loaded");
    //   });
    // }

    if(cube.hasLoaded){
      console.log("cube loaded");
    }else{
      cube.addEventListener('loaded', function(){
        console.log("cube loaded");
      });
    }

    cube.addEventListener("materialtextureloaded", function(){
      console.log("materialtextureloaded");
    });
      
    // if(assets.hasLoaded){
    //   console.log("assets loaded");
    // }else{
    //   assets.addEventListener('loaded', function(){
    //     console.log("assets loaded");
    //   });
    // }
    

    function run () {
      console.log("updating cubemap texture");
      setTimeout(function(){
        document.querySelector("#cube1").setAttribute('material', {envMap: '#sky'});
      }, 5000);
    }
  </script>
</html>